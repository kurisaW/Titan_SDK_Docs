

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Driver Gpt &mdash; Titan_SDK_Docs 0.0.1 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5a0213dc"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/translations.js?v=beaddf03"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Driver Hyperram" href="driver_hyperram.html" />
    <link rel="prev" title="Driver Rtc" href="driver_rtc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Titan_SDK_Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">目录</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">快速开始</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic_examples/index.html">基础功能示例</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">驱动示例</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="driver_iic_ist8310.html">Driver Iic Ist8310</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver_spi_bmi088.html">Driver Spi Bmi088</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver_usb_pcdc.html">Driver Usb Pcdc</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver_rtc.html">Driver Rtc</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Driver Gpt</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver_hyperram.html">Driver Hyperram</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver_usb_hhid.html">Driver Usb Hhid</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver_rgb_lcd.html">Driver Rgb Lcd</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver_wifi.html">Driver Wifi</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver_sdcard.html">Driver Sdcard</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver_adc.html">Driver Adc</a></li>
<li class="toctree-l2"><a class="reference internal" href="driver_wdt.html">Driver Wdt</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../component_examples/index.html">组件示例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/index.html">使用说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">常见问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">开发指南</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Titan_SDK_Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">驱动示例</a></li>
      <li class="breadcrumb-item active">Driver Gpt</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/driver_examples/driver_gpt.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="driver-gpt">
<h1>Driver Gpt<a class="headerlink" href="#driver-gpt" title="Link to this heading"></a></h1>
<p><strong>中文</strong> | <a class="reference external" href="{project_name}_en">English</a></p>
<p># RA8P1 Titan Board 开发板 GPT 使用说明
RA8P1 Titan Board 开发板 GPT 使用说明
==</p>
<p><strong>中文</strong> | <a class="reference external" href="./README_EN.md">**English**</a></p>
<p>## 简介
简介
--</p>
<p>在我们具体的应用场合中往往都离不开 timer 的使用，本例程主要介绍了如何在 Titan Board 上使用 GPT 设备，包括基本定时器的使用和 PWM 的使用。</p>
<p>## FSP配置说明
FSP配置说明
--</p>
<p>FSP 分别配置使能 GPT1 为基本定时器模式，GPT12 为 PWM 模式：</p>
<img alt="image-20250730143410015" src="driver_examples/figures/image-20250730143410015.png" />
<img alt="image-20250730143446125" src="driver_examples/figures/image-20250730143446125.png" />
<p>并配置 Pins 使能 GPT12：</p>
<img alt="image-20250730143622345" src="driver_examples/figures/image-20250730143622345.png" />
<p>### RT-Thread Settings配置
RT-Thread Settings配置
~~</p>
<p>在配置中打开 timer1 使能与 PWM12 使能：</p>
<img alt="image-20250730143710093" src="driver_examples/figures/image-20250730143710093.png" />
<img alt="image-20250730143737261" src="driver_examples/figures/image-20250730143737261.png" />
<p>### 示例工程说明
示例工程说明
~~</p>
<p>本例程的源码位于:code:<cite>/projects/Titan_driver_gpt</cite>：</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>/* This is a hwtimer example <em>/
#define HWTIMER_DEV_NAME &quot;timer1&quot; /</em> device name <a href="#id2"><span class="problematic" id="id3">*</span></a>/
static rt_err_t timeout_cb(rt_device_t dev, rt_size_t size)
{</p>
<blockquote>
<div><p>rt_kprintf(&quot;this is hwtimer timeout callback fucntion!n&quot;);
rt_kprintf(&quot;tick is :%d !n&quot;, rt_tick_get());
return RT_EOK;</p>
</div></blockquote>
<p>}</p>
<p>int hwtimer_sample(void)
{</p>
<blockquote>
<div><p>rt_err_t ret = RT_EOK;
rt_hwtimerval_t timeout_s;
rt_device_t hw_dev = RT_NULL;
rt_hwtimer_mode_t mode;</p>
<p>rt_uint32_t freq = R_FSP_SystemClockHzGet(FSP_PRIV_CLOCK_PCLKD) &gt;&gt; g_timer1_cfg.source_div;
rt_kprintf(&quot;GPT Timer clock freq is: %d hzn&quot;, freq);</p>
<p>hw_dev = rt_device_find(HWTIMER_DEV_NAME);
if (hw_dev == RT_NULL)
{</p>
<blockquote>
<div><p>rt_kprintf(&quot;hwtimer sample run failed! can't find %s device!n&quot;, HWTIMER_DEV_NAME);
return -RT_ERROR;</p>
</div></blockquote>
<p>}</p>
<p>ret = rt_device_open(hw_dev, RT_DEVICE_OFLAG_RDWR);
if (ret != RT_EOK)
{</p>
<blockquote>
<div><p>rt_kprintf(&quot;open %s device failed!n&quot;, HWTIMER_DEV_NAME);
return ret;</p>
</div></blockquote>
<p>}</p>
<p>rt_device_set_rx_indicate(hw_dev, timeout_cb);</p>
<p>rt_device_control(hw_dev, HWTIMER_CTRL_FREQ_SET, &amp;freq);</p>
<p>mode = HWTIMER_MODE_PERIOD;
ret = rt_device_control(hw_dev, HWTIMER_CTRL_MODE_SET, &amp;mode);
if (ret != RT_EOK)
{</p>
<blockquote>
<div><p>rt_kprintf(&quot;set mode failed! ret is :%dn&quot;, ret);
return ret;</p>
</div></blockquote>
<p>}</p>
<p>/* Example Set the timeout period of the timer <em>/
timeout_s.sec = 1;  /</em> secend <em>/
timeout_s.usec = 0; /</em> microsecend <a href="#id4"><span class="problematic" id="id5">*</span></a>/
if (rt_device_write(hw_dev, 0, &amp;timeout_s, sizeof(timeout_s)) != sizeof(timeout_s))
{</p>
<blockquote>
<div><p>rt_kprintf(&quot;set timeout value failedn&quot;);
return -RT_ERROR;</p>
</div></blockquote>
<p>}</p>
<p>/* read hwtimer value <a href="#id6"><span class="problematic" id="id7">*</span></a>/
rt_device_read(hw_dev, 0, &amp;timeout_s, sizeof(timeout_s));
rt_kprintf(&quot;Read: Sec = %d, Usec = %dn&quot;, timeout_s.sec, timeout_s.usec);</p>
<p>return ret;</p>
</div></blockquote>
<p>}
MSH_CMD_EXPORT(hwtimer_sample, hwtimer sample);</p>
<p>每隔 1s 触发一次中断回调函数打印输出，下面是 PWM 配置使能：</p>
<p>PWM 相关宏定义：</p>
<p>当前版本的 PWM 驱动将每个通道都看做一个单独的 PWM 设备，每个设备都只有一个通道 0。使用 PWM12 设备，注意此处通道选择为 0 通道；</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>#define PWM_DEV_NAME        &quot;pwm12&quot; /* PWM设备名称 <em>/
#define PWM_DEV_CHANNEL      0      /</em> PWM通道 <em>/
struct rt_device_pwm *pwm_dev;      /</em> PWM设备句柄 <a href="#id8"><span class="problematic" id="id9">*</span></a>/</p>
<p>配置 PWM 周期以及占空比：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>static int pwm_sample(int argc, char <a href="#id10"><span class="problematic" id="id11">*</span></a>argv[])
{</p>
<blockquote>
<div><p>rt_uint32_t period, pulse;</p>
<p>if (argc != 3)
{</p>
<blockquote>
<div><p>LOG_I(&quot;Usage: pwm_sample &lt;period&gt; &lt;pulse&gt;&quot;);
LOG_I(&quot;Example: pwm_sample 500000 250000&quot;);
return -RT_ERROR;</p>
</div></blockquote>
<p>}</p>
<p>period = (rt_uint32_t)atoi(argv[1]);
pulse  = (rt_uint32_t)atoi(argv[2]);</p>
<p>if (period == 0 || pulse &gt; period)
{</p>
<blockquote>
<div><p>LOG_E(&quot;Error: Invalid parameters. Ensure period &gt; 0 and pulse &lt;= period.&quot;);
return -RT_ERROR;</p>
</div></blockquote>
<p>}</p>
<p>pwm_dev = (struct rt_device_pwm <a href="#id12"><span class="problematic" id="id13">*</span></a>)rt_device_find(PWM_DEV_NAME);
if (pwm_dev == RT_NULL)
{</p>
<blockquote>
<div><p>LOG_E(&quot;Error: Cannot find PWM device named '%s'n&quot;, PWM_DEV_NAME);
return -RT_ERROR;</p>
</div></blockquote>
<p>}</p>
<p>if (rt_pwm_set(pwm_dev, PWM_DEV_CHANNEL, period, pulse) != RT_EOK)
{</p>
<blockquote>
<div><p>LOG_E(&quot;Error: Failed to set PWM configuration.&quot;);
return -RT_ERROR;</p>
</div></blockquote>
<p>}</p>
<p>if (rt_pwm_enable(pwm_dev, PWM_DEV_CHANNEL) != RT_EOK)
{</p>
<blockquote>
<div><p>LOG_E(&quot;Error: Failed to enable PWM output.&quot;);
return -RT_ERROR;</p>
</div></blockquote>
<p>}</p>
<p>LOG_I(&quot;PWM started on device: %s, channel: %d&quot;, PWM_DEV_NAME, PWM_DEV_CHANNEL);
LOG_I(&quot;Period: %u ns, Pulse: %u ns&quot;, period, pulse);
LOG_I(&quot;Please connect the 'P714' to a logic analyzer or oscilloscope for waveform observation.&quot;);</p>
<p>return RT_EOK;</p>
</div></blockquote>
<p>}
MSH_CMD_EXPORT(pwm_sample, Configure and start PWM output: pwm_sample &lt;period&gt; &lt;pulse&gt;);</p>
<dl class="simple">
<dt>##  编译&amp;下载</dt><dd><p>编译&amp;下载</p>
</dd>
</dl>
<p>--</p>
<ul class="simple">
<li><p>RT-Thread Studio：在 RT-Thread Studio 的包管理器中下载 Titan Board 资源包，然后创建新工程，执行编译。</p></li>
</ul>
<p>编译完成后，将开发板的 Jlink 接口与 PC 机连接，然后将固件下载至开发板。</p>
<p>## 运行效果
运行效果
--</p>
<p>在串口终端分别输入pwm_sample、hwtimer_sample查看具体效果；</p>
<p>每隔 1s 触发回调函数并打印输出：</p>
<img alt="PixPin_2025-07-25_15-19-27" src="driver_examples/figures/PixPin_2025-07-25_15-19-27.png" />
<p>使用逻辑分析仪量取 PWM 输出波形如下所示：</p>
<img alt="PixPin_2025-07-25_15-22-07" src="driver_examples/figures/PixPin_2025-07-25_15-22-07.png" />
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="driver_rtc.html" class="btn btn-neutral float-left" title="Driver Rtc" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="driver_hyperram.html" class="btn btn-neutral float-right" title="Driver Hyperram" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2025, apache。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>